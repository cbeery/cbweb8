<!-- app/views/admin/viewings/_form.html.erb -->
<%= form_with model: [@movie, @viewing], url: @viewing.persisted? ? admin_movie_viewing_path(@movie, @viewing) : admin_movie_viewings_path(@movie), local: true do |f| %>
  <% if @viewing.errors.any? %>
    <div class="mb-4 bg-red-50 border border-red-200 rounded-md p-4">
      <h3 class="text-sm font-medium text-red-800">
        <%= pluralize(@viewing.errors.count, "error") %> prohibited this viewing from being saved:
      </h3>
      <ul class="mt-2 text-sm text-red-700 list-disc list-inside">
        <% @viewing.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="space-y-4">
    <div>
      <%= f.label :viewed_on, "Date Watched", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= f.date_field :viewed_on,
          class: "w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",
          required: true %>
    </div>

    <div>
      <%= f.label :location, "Location", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= f.select :location, 
          options_for_select([
            ['Home', 'home'],
            ['Theater', 'theater'],
            ['Streaming', 'streaming'],
            ['Other', 'other']
          ], @viewing.location),
          { include_blank: 'Select location...' },
          class: "w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div>
      <%= f.label :notes, "Notes (optional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= f.text_area :notes,
          rows: 3,
          placeholder: "Your thoughts about this viewing...",
          class: "w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div class="flex items-center">
      <%= f.check_box :rewatch,
          class: "rounded border-gray-300 text-indigo-600 focus:ring-indigo-500" %>
      <%= f.label :rewatch, "This was a rewatch", class: "ml-2 text-sm text-gray-700" %>
    </div>
  </div>

  <div class="mt-6 flex space-x-3">
    <%= f.submit @viewing.persisted? ? "Update Viewing" : "Add Viewing",
        class: "px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 cursor-pointer font-medium" %>
    <%= link_to "Cancel",
        admin_movie_path(@movie),
        class: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium" %>
  </div>
<% end %>
