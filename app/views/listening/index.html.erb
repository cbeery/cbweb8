<%# app/views/listening/index.html.erb %>
<% content_for(:title) { "Listening | curt.beery.co" } %>

<%# Define sidebar content using content_for blocks %>

<% content_for :public_page_header do %>
  <h1 class="text-3xl font-bold text-gray-900">Listening</h1>
  <p class="mt-1 text-lg text-gray-600">Music stats from Last.fm since 2008</p>
<% end %>

<% content_for :sidebar_intro do %>
  <p class="text-sm text-gray-600">
    Tracking what I listen to via <a href="https://www.last.fm/user/cabeery" class="text-indigo-600 hover:text-indigo-800">Last.fm</a>.
    I've been scrobbling since August 2008.
  </p>
<% end %>

<% content_for :sidebar_nav do %>
  <ul class="mt-2 lg:mt-0 space-y-1">
    <li>
      <%= link_to "Artists", "#artists",
          class: "block py-2 px-3 lg:px-2 text-gray-700 hover:bg-gray-50 hover:text-indigo-600 rounded-md transition-colors" %>
    </li>
    <li>
      <%= link_to "Albums", "#albums",
          class: "block py-2 px-3 lg:px-2 text-gray-700 hover:bg-gray-50 hover:text-indigo-600 rounded-md transition-colors" %>
    </li>
    <li>
      <%= link_to "Tracks", "#tracks",
          class: "block py-2 px-3 lg:px-2 text-gray-700 hover:bg-gray-50 hover:text-indigo-600 rounded-md transition-colors" %>
    </li>
  </ul>
<% end %>

<% content_for :sidebar_details do %>
  <div class="bg-gray-50 rounded-lg p-4">
    <h4 class="text-sm font-medium text-gray-700 mb-2">Quick Stats</h4>
    <ul class="text-sm text-gray-600 space-y-1">
      <li>Scrobbling since: August 2008</li>
      <% if @top_artists_overall.any? %>
        <li>Top artist all-time: <%= @top_artists_overall.first.artist %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= render 'shared/public_page/layout',
           sidebar_nav_title: "Sections",
           show_sidebar: true do %>

  <%# ===================== %>
  <%# ARTISTS SECTION %>
  <%# ===================== %>
  <section id="artists" class="mb-10">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">Top Artists</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <%= render 'scrobble_chart',
                 title: "Last Week",
                 scrobbles: @top_artists_week,
                 images: @artist_images,
                 category: 'artist' %>

      <%= render 'scrobble_chart',
                 title: "Last Month",
                 scrobbles: @top_artists_month,
                 images: @artist_images,
                 category: 'artist' %>

      <%= render 'scrobble_chart',
                 title: "Last Year",
                 scrobbles: @top_artists_year,
                 images: @artist_images,
                 category: 'artist' %>

      <%= render 'scrobble_chart',
                 title: "All-Time",
                 scrobbles: @top_artists_overall,
                 images: @artist_images,
                 category: 'artist' %>
    </div>
  </section>

  <%# ===================== %>
  <%# ALBUMS SECTION %>
  <%# ===================== %>
  <section id="albums" class="mb-10">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">Top Albums</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <%= render 'scrobble_chart',
                 title: "Last Month",
                 scrobbles: @top_albums_month,
                 images: @album_images,
                 category: 'album' %>

      <%= render 'scrobble_chart',
                 title: "Last Year",
                 scrobbles: @top_albums_year,
                 images: @album_images,
                 category: 'album' %>
    </div>
  </section>

  <%# ===================== %>
  <%# TRACKS SECTION %>
  <%# ===================== %>
  <section id="tracks" class="mb-10">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">Top Tracks</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <%= render 'scrobble_chart',
                 title: "Last Month",
                 scrobbles: @top_tracks_month,
                 images: @track_images,
                 category: 'track' %>

      <%= render 'scrobble_chart',
                 title: "Last Year",
                 scrobbles: @top_tracks_year,
                 images: @track_images,
                 category: 'track' %>
    </div>
  </section>

<% end %>
